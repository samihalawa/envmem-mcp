name = "envmem"
main = "src/index.ts"
compatibility_date = "2024-12-13"
compatibility_flags = ["nodejs_compat"]  # CRITICAL: Required for MCP SDK

routes = [
	{ pattern = "envmem.com", custom_domain = true },
	{ pattern = "www.envmem.com", custom_domain = true }
]

# Cloudflare Workers AI with Gateway for observability
[ai]
binding = "AI"
# gateway = "your-gateway-id"  # Uncomment for AI Gateway observability

# Cloudflare D1 Database (SQLite) for metadata
[[d1_databases]]
binding = "DB"
database_name = "env-reference-db"
database_id = "b75fd3ed-511d-4b3b-81bb-45b53bf2f432"

# Cloudflare Vectorize for semantic search (768 dimensions for BGE-base-en-v1.5)
[[vectorize]]
binding = "VECTORIZE"
index_name = "env-embeddings"

# Queue disabled (requires paid plan) - using sync embedding generation

# Observability
[observability]
enabled = true
head_sampling_rate = 0.1

# Static assets for landing page
[assets]
directory = "./public"

# Environment variables
[vars]
ENVIRONMENT = "production"